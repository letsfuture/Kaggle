# 경진 대회의 평가지표

## 1. 경진 대회의 종류

### 1) 회귀 문제

- 물건 가격이나 주가의 투자수익 또는 매장 방문자 수와 같은 수치를 예측하는 문제
- **평가지표**
  - RMSE, MAE

### 2) 분류 문제

- **이진 분류(binary classification)**
  - 환자가 병에 걸렸는지 아닌지와 같이 데이터가 어떤 속성에 속하는지를 예측하는 문제
  - 0 또는 1의 레이블로 예측하는 경우와 0에서 1 사이의 확률로 예측하는 경우로 나뉨.
  - **평가지표**
    - F1-score, 로그 손실, AUC
- **다중 클래스 분류(multi-class classification)**
  - 행 데이터가 여러 클래스 중 어느 하나의 선택지에 속하는 다중 클래스 분류 문제와 동시에 여러 클래스에 속하는 다중 레이블 분류 문제로 나뉨.
  - **평가지표**
    - 다중 클래스 분류 :point_right: 다중 클래스 로그 손실
    - 다중 레이블 분류 :point_right: mean-F1 또는 macro-F1

### 3) 추천 문제

- 고객의 구매가 기대되는 상품과 반응이 있을 법한 광고 등을 예측하는 문제
- 고객별로 상품과 광고를 여러 개 예측하는 경우
- **평가지표**
  - 순위를 매겨 예측값을 제출할 때는 MAP@K
  - 순위를 매기지 않을 때는 mean-F1 또는 macro-F1을 사용

### 4) 기타

- **객체 탐지(object detection)**

  이미지에 포함된 물체의 클래스와 해당 물체가 존재하는 직사각형의 경계 박스 영역을 추정하는 문제

- **세분화(segmentation)**

  포함된 물체의 영역을 이미지 픽셀 단위로 추정하는 문제

<br>

## 2. 평가지표

### 1) 회귀의 평가지표

- **RMSE(Root Mean Square Error)**
  - 각 행 데이터에 대한 예측값과 실젯값 차이를 제곱하고, 그 값의 평균을 내 제곱근을 구하는 것
  - MAE와 비교하면 이상치의 영향을 받기 쉬우므로, 이상치를 제외한 처리 등을 미리 해두지 않으면 이상치에 과적합 모델을 만들 가능성이 있음.
  - 사이킷런 `metrics` 모듈의 `mean_squared_error`를 사용
  
- **RMSLE(Root Mean Square Logarithmic Error)**
  - 실젯값과 예측값의 로그를 각각 취한 후, 그 차의 제곱평균제곱근으로 계산되는 지표
  - 사이킷런 `metrics` 모듈의 `mean_squared_log_error` 함수를 사용하여 계산할 수 있음.
- **MAE(Mean Absolute Error)**
  - 실젯값과 예측값의 차에 대한 절댓값의 평균으로 계산되는 지표
  - 이상치의 영향을 상대적으로 줄여주는 평가에 적절한 함수
  - 사이킷런 `metrics` 모듈의 `mean_absolute_error` 함수를 사용하여 계산할 수 있음.
- **결정계수(coefficient of determination)**
  - 회귀분석의 적합성을 나타냄
  - 분모는 예측값에 의존하지 않고, 분자는 오차의 제곱에 관한 것이므로 이 지표의 최대화가 곧 RMSE의 최소화와 같음.
  - 결정계수의 최댓값밧은 1이므로 1에 가까워질수록 모델 성능이 높은 예측으로 볼 수 있음.
  - 사이킷런 `metrics` 모듈의 `r2_socre` 함수로 계산할 수 있음.

### 2) 이진 분류의 평가지표(1)

- **혼동행렬(confusion matrix)**
- **정확도와 오류율**
  - 정확하게 예측한 행 데이터 수를 전체 행 데이터 수로 나누어 구할 수 있음.
  - 사이킷런 `metrics` 모듈의 `accuracy_score` 함수를 이용해 계산할 수 있음.
- **정밀도와 재현율**
  - 정밀도: 양성으로 예측한 값 중에서도 실젯값도 양성일 비율
  - 재현율: 실젯값이 양성인 것 중에 예측값이 양성일 비율
  - 정밀도와 재현율은 어느 한 쪽의 값을 높이려 할 때 다른 쪽의 값은 낮아지는 트레이드 오프 관계임.
  - 사이킷런 `metrics` 모듈의 `precision_score` 함수와 `recall_score` 함수를 이용하여 계산할 수 있음.
- **F1-score와 Fβ-score**
  - F1-score: 정밀도와 재현율의 조화 평균으로 계산되는 지표
  - Fβ-score: F1-score에서 구한 정밀도와 재현율의 균형에서 계수 β에 따라 재현율에 가중치를 주어 조정한 지표
  - 사이킷런 `metrics` 모듈의 `f1_score` 함수와 `fbeta_score` 함수로 계산할 수 있음.

- **매튜상관계수(MCC)**
  - 사용 빈도는 높지 않지만 불균형 데이터의 모델 성능을 적절히 평가하기 쉬운 지표
  - 사이킷런 `metrics` 모듈의 `matthews_corrcoef` 함수로 계산할 수 있음.

### 3) 이진 분류의 평가지표(2)

- **로그 손실**
  - 분류 문제의 대표적인 평가지표이며, 교차 엔트로피(cross-entropy)라고 부르기도 함.
  - 로그 손실이 낮을수록 좋은 지표
  - 사이킷런 `metrics` 모듈의 `log_loss` 함수로 계산할 수 있음
- **AUC(Area Under the ROC Curve)**
  - ROC(Receiver Operating characteristic curve)을 이용해 계산
  - 사이킷런 `metrics` 모듈의 `roc_auc_score` 함수로 계산할 수 있음.

### (4) 다중 클래스 분류의 평가지표

- **multi-class accuracy**
  - 사이킷런 `metrics` 모듈의 `accuracy_score` 함수로 계산
- **multi-class logloss**
  - 사이킷런 `metrics` 모듈의 `log_loss` 함수로 계산
- **mean-F1, macro-F1, micro-F1**
  - 사이킷런 `metrics` 모듈의 `f1_score` 함수로 계산

### (5) 추천의 평가지표

- **MAP@K(Mean Average Precision at(@) K)**
  - 각 행 데이터가 하나 또는 여러 클래스에 속할 때, 포함될 가능성이 높을 것으로 예측한 순서대로 K개의 클래스를 예측값으로 삼음.

<br>

## 3. 평가지표와 목적함수

- **목적함수:** 모델 학습 시 최적화되는 함수
- **회귀 문제**에서는 **RMSE**, **분류 문제**에서는 **로그 손실**을 목적함수로 많이 사용 

<br>

# [참고자료]

데이터가 뛰어노는 AI 놀이터, 캐글
